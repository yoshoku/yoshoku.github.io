<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.24
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-Rumale">Rumale</h1>

<p><img src="https://dl.dropboxusercontent.com/s/joxruk2720ur66o/rumale_header_400.png"></p>

<p><a href="https://travis-ci.org/yoshoku/rumale"><img src="https://travis-ci.org/yoshoku/rumale.svg?branch=master"></a> <a href="https://coveralls.io/github/yoshoku/rumale?branch=master"><img src="https://coveralls.io/repos/github/yoshoku/rumale/badge.svg?branch=master"></a> <a href="https://badge.fury.io/rb/rumale"><img src="https://badge.fury.io/rb/rumale.svg"></a> <a href="https://github.com/yoshoku/rumale/blob/master/LICENSE.txt"><img src="https://img.shields.io/badge/License-BSD%202--Clause-orange.svg"></a> <a href="https://yoshoku.github.io/rumale/doc/"><img src="https://img.shields.io/badge/api-reference-blue.svg"></a></p>

<p>Rumale (*Ru*by *ma*chine *le*arning) is a machine learning library in Ruby. Rumale provides machine learning algorithms with interfaces similar to Scikit-Learn in Python. Rumale supports Support Vector Machine, Logistic Regression, Ridge, Lasso, Factorization Machine, Multi-layer Perceptron, Naive Bayes, Decision Tree, Gradient Tree Boosting, Random Forest, K-Means, Gaussian Mixture Model, DBSCAN, Spectral Clustering, Mutidimensional Scaling, t-SNE, Fisher Discriminant Analysis, Neighbourhood Component Analysis, Principal Component Analysis, Non-negative Matrix Factorization, and many other algorithms.</p>

<h2 id="label-Installation">Installation</h2>

<p>Add this line to your application&#39;s Gemfile:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rumale</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>And then execute:</p>

<pre class="code ruby"><code class="ruby">$ bundle
</code></pre>

<p>Or install it yourself as:</p>

<pre class="code ruby"><code class="ruby">$ gem install rumale
</code></pre>

<h2 id="label-Documentation">Documentation</h2>
<ul><li>
<p><a href="https://yoshoku.github.io/rumale/doc/">Rumale API Documentation</a></p>
</li></ul>

<h2 id="label-Usage">Usage</h2>

<h3 id="label-Example+1.+XOR+data">Example 1. XOR data</h3>

<p>First, let&#39;s classify simple xor data.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rumale</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Prepare XOR data.
</span><span class='id identifier rubyid_samples'>samples</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>1</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
<span class='id identifier rubyid_labels'>labels</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>0</span><span class='rbracket'>]</span>

<span class='comment'># Train classifier with nearest neighbor rule.
</span><span class='id identifier rubyid_estimator'>estimator</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/NearestNeighbors.html" title="Rumale::NearestNeighbors (module)">NearestNeighbors</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/NearestNeighbors/KNeighborsClassifier.html" title="Rumale::NearestNeighbors::KNeighborsClassifier (class)">KNeighborsClassifier</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rumale/NearestNeighbors/KNeighborsClassifier.html#initialize-instance_method" title="Rumale::NearestNeighbors::KNeighborsClassifier#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>n_neighbors:</span> <span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_estimator'>estimator</span><span class='period'>.</span><span class='id identifier rubyid_fit'>fit</span><span class='lparen'>(</span><span class='id identifier rubyid_samples'>samples</span><span class='comma'>,</span> <span class='id identifier rubyid_labels'>labels</span><span class='rparen'>)</span>

<span class='comment'># Predict labels.
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_labels'>labels</span>
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_estimator'>estimator</span><span class='period'>.</span><span class='id identifier rubyid_predict'>predict</span><span class='lparen'>(</span><span class='id identifier rubyid_samples'>samples</span><span class='rparen'>)</span>
</code></pre>

<p>Execution of the above script result in the following.</p>

<pre class="code ruby"><code class="ruby"><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>0</span><span class='rbracket'>]</span>
<span class='const'>Numo</span><span class='op'>::</span><span class='const'>Int32</span><span class='comment'>#shape=[4]
</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>0</span><span class='rbracket'>]</span>
</code></pre>

<p>The basic usage of Rumale is to first train the model with the fit method and then estimate with the predict method. In addition, Rumale recommends using arrays such as feature vectors and labels with <a href="https://github.com/ruby-numo/numo-narray">Numo::NArray</a>.</p>

<h3 id="label-Example+2.+Pendigits+dataset+classification">Example 2. Pendigits dataset classification</h3>

<p>Rumale provides function loading libsvm format dataset file. We start by downloading the pendigits dataset from LIBSVM Data web site.</p>

<pre class="code ruby"><code class="ruby">$ wget https://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/multiclass/pendigits
$ wget https://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/multiclass/pendigits.t
</code></pre>

<p>Training of the classifier with Linear SVM and RBF kernel feature map is the following code.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rumale</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Load the training dataset.
</span><span class='id identifier rubyid_samples'>samples</span><span class='comma'>,</span> <span class='id identifier rubyid_labels'>labels</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/Dataset.html" title="Rumale::Dataset (module)">Dataset</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_libsvm_file'><span class='object_link'><a href="Rumale/Dataset.html#load_libsvm_file-class_method" title="Rumale::Dataset.load_libsvm_file (method)">load_libsvm_file</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pendigits</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># Map training data to RBF kernel feature space.
</span><span class='id identifier rubyid_transformer'>transformer</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/KernelApproximation.html" title="Rumale::KernelApproximation (module)">KernelApproximation</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/KernelApproximation/RBF.html" title="Rumale::KernelApproximation::RBF (class)">RBF</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rumale/KernelApproximation/RBF.html#initialize-instance_method" title="Rumale::KernelApproximation::RBF#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>gamma:</span> <span class='float'>0.0001</span><span class='comma'>,</span> <span class='label'>n_components:</span> <span class='int'>1024</span><span class='comma'>,</span> <span class='label'>random_seed:</span> <span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_transformed'>transformed</span> <span class='op'>=</span> <span class='id identifier rubyid_transformer'>transformer</span><span class='period'>.</span><span class='id identifier rubyid_fit_transform'>fit_transform</span><span class='lparen'>(</span><span class='id identifier rubyid_samples'>samples</span><span class='rparen'>)</span>

<span class='comment'># Train linear SVM classifier.
</span><span class='id identifier rubyid_classifier'>classifier</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/LinearModel.html" title="Rumale::LinearModel (module)">LinearModel</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/LinearModel/SVC.html" title="Rumale::LinearModel::SVC (class)">SVC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rumale/LinearModel/SVC.html#initialize-instance_method" title="Rumale::LinearModel::SVC#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>reg_param:</span> <span class='float'>0.0001</span><span class='comma'>,</span> <span class='label'>random_seed:</span> <span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_classifier'>classifier</span><span class='period'>.</span><span class='id identifier rubyid_fit'>fit</span><span class='lparen'>(</span><span class='id identifier rubyid_transformed'>transformed</span><span class='comma'>,</span> <span class='id identifier rubyid_labels'>labels</span><span class='rparen'>)</span>

<span class='comment'># Save the model.
</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>transformer.dat</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wb</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='const'>Marshal</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span><span class='lparen'>(</span><span class='id identifier rubyid_transformer'>transformer</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>classifier.dat</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wb</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='const'>Marshal</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span><span class='lparen'>(</span><span class='id identifier rubyid_classifier'>classifier</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
</code></pre>

<p>Classifying testing data with the trained classifier is the following code.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rumale</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Load the testing dataset.
</span><span class='id identifier rubyid_samples'>samples</span><span class='comma'>,</span> <span class='id identifier rubyid_labels'>labels</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/Dataset.html" title="Rumale::Dataset (module)">Dataset</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_libsvm_file'><span class='object_link'><a href="Rumale/Dataset.html#load_libsvm_file-class_method" title="Rumale::Dataset.load_libsvm_file (method)">load_libsvm_file</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pendigits.t</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># Load the model.
</span><span class='id identifier rubyid_transformer'>transformer</span> <span class='op'>=</span> <span class='const'>Marshal</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_binread'>binread</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>transformer.dat</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='id identifier rubyid_classifier'>classifier</span> <span class='op'>=</span> <span class='const'>Marshal</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_binread'>binread</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>classifier.dat</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>

<span class='comment'># Map testing data to RBF kernel feature space.
</span><span class='id identifier rubyid_transformed'>transformed</span> <span class='op'>=</span> <span class='id identifier rubyid_transformer'>transformer</span><span class='period'>.</span><span class='id identifier rubyid_transform'>transform</span><span class='lparen'>(</span><span class='id identifier rubyid_samples'>samples</span><span class='rparen'>)</span>

<span class='comment'># Classify the testing data and evaluate prediction results.
</span><span class='id identifier rubyid_puts'>puts</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Accuracy: %.1f%%</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lparen'>(</span><span class='float'>100.0</span> <span class='op'>*</span> <span class='id identifier rubyid_classifier'>classifier</span><span class='period'>.</span><span class='id identifier rubyid_score'>score</span><span class='lparen'>(</span><span class='id identifier rubyid_transformed'>transformed</span><span class='comma'>,</span> <span class='id identifier rubyid_labels'>labels</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>

<span class='comment'># Other evaluating approach
</span><span class='comment'># results = classifier.predict(transformed)
</span><span class='comment'># evaluator = Rumale::EvaluationMeasure::Accuracy.new
</span><span class='comment'># puts(&quot;Accuracy: %.1f%%&quot; % (100.0 * evaluator.score(results, labels)))
</span></code></pre>

<p>Execution of the above scripts result in the following.</p>

<pre class="code ruby"><code class="ruby">$ ruby train.rb
$ ruby test.rb
Accuracy: 98.7%
</code></pre>

<h3 id="label-Example+3.+Cross-validation">Example 3. Cross-validation</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rumale</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Load dataset.
</span><span class='id identifier rubyid_samples'>samples</span><span class='comma'>,</span> <span class='id identifier rubyid_labels'>labels</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/Dataset.html" title="Rumale::Dataset (module)">Dataset</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_libsvm_file'><span class='object_link'><a href="Rumale/Dataset.html#load_libsvm_file-class_method" title="Rumale::Dataset.load_libsvm_file (method)">load_libsvm_file</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pendigits</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># Define the estimator to be evaluated.
</span><span class='id identifier rubyid_lr'>lr</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/LinearModel.html" title="Rumale::LinearModel (module)">LinearModel</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/LinearModel/LogisticRegression.html" title="Rumale::LinearModel::LogisticRegression (class)">LogisticRegression</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rumale/LinearModel/LogisticRegression.html#initialize-instance_method" title="Rumale::LinearModel::LogisticRegression#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>learning_rate:</span> <span class='float'>0.00001</span><span class='comma'>,</span> <span class='label'>reg_param:</span> <span class='float'>0.0001</span><span class='comma'>,</span> <span class='label'>random_seed:</span> <span class='int'>1</span><span class='rparen'>)</span>

<span class='comment'># Define the evaluation measure, splitting strategy, and cross validation.
</span><span class='id identifier rubyid_ev'>ev</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/EvaluationMeasure.html" title="Rumale::EvaluationMeasure (module)">EvaluationMeasure</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/EvaluationMeasure/LogLoss.html" title="Rumale::EvaluationMeasure::LogLoss (class)">LogLoss</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_kf'>kf</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/ModelSelection.html" title="Rumale::ModelSelection (module)">ModelSelection</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/ModelSelection/StratifiedKFold.html" title="Rumale::ModelSelection::StratifiedKFold (class)">StratifiedKFold</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rumale/ModelSelection/StratifiedKFold.html#initialize-instance_method" title="Rumale::ModelSelection::StratifiedKFold#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>n_splits:</span> <span class='int'>5</span><span class='comma'>,</span> <span class='label'>shuffle:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>random_seed:</span> <span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_cv'>cv</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/ModelSelection.html" title="Rumale::ModelSelection (module)">ModelSelection</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/ModelSelection/CrossValidation.html" title="Rumale::ModelSelection::CrossValidation (class)">CrossValidation</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rumale/ModelSelection/CrossValidation.html#initialize-instance_method" title="Rumale::ModelSelection::CrossValidation#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>estimator:</span> <span class='id identifier rubyid_lr'>lr</span><span class='comma'>,</span> <span class='label'>splitter:</span> <span class='id identifier rubyid_kf'>kf</span><span class='comma'>,</span> <span class='label'>evaluator:</span> <span class='id identifier rubyid_ev'>ev</span><span class='rparen'>)</span>

<span class='comment'># Perform 5-cross validation.
</span><span class='id identifier rubyid_report'>report</span> <span class='op'>=</span> <span class='id identifier rubyid_cv'>cv</span><span class='period'>.</span><span class='id identifier rubyid_perform'>perform</span><span class='lparen'>(</span><span class='id identifier rubyid_samples'>samples</span><span class='comma'>,</span> <span class='id identifier rubyid_labels'>labels</span><span class='rparen'>)</span>

<span class='comment'># Output result.
</span><span class='id identifier rubyid_mean_logloss'>mean_logloss</span> <span class='op'>=</span> <span class='id identifier rubyid_report'>report</span><span class='lbracket'>[</span><span class='symbol'>:test_score</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='symbol'>:+</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='id identifier rubyid_kf'>kf</span><span class='period'>.</span><span class='id identifier rubyid_n_splits'>n_splits</span>
<span class='id identifier rubyid_puts'>puts</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5-CV mean log-loss: %.3f</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_mean_logloss'>mean_logloss</span><span class='rparen'>)</span>
</code></pre>

<p>Execution of the above scripts result in the following.</p>

<pre class="code ruby"><code class="ruby">$ ruby cross_validation.rb
5-CV mean log-loss: 0.355
</code></pre>

<h3 id="label-Example+4.+Pipeline">Example 4. Pipeline</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rumale</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Load dataset.
</span><span class='id identifier rubyid_samples'>samples</span><span class='comma'>,</span> <span class='id identifier rubyid_labels'>labels</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/Dataset.html" title="Rumale::Dataset (module)">Dataset</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_libsvm_file'><span class='object_link'><a href="Rumale/Dataset.html#load_libsvm_file-class_method" title="Rumale::Dataset.load_libsvm_file (method)">load_libsvm_file</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pendigits</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># Construct pipeline with kernel approximation and SVC.
</span><span class='id identifier rubyid_rbf'>rbf</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/KernelApproximation.html" title="Rumale::KernelApproximation (module)">KernelApproximation</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/KernelApproximation/RBF.html" title="Rumale::KernelApproximation::RBF (class)">RBF</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rumale/KernelApproximation/RBF.html#initialize-instance_method" title="Rumale::KernelApproximation::RBF#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>gamma:</span> <span class='float'>0.0001</span><span class='comma'>,</span> <span class='label'>n_components:</span> <span class='int'>800</span><span class='comma'>,</span> <span class='label'>random_seed:</span> <span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_svc'>svc</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/LinearModel.html" title="Rumale::LinearModel (module)">LinearModel</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/LinearModel/SVC.html" title="Rumale::LinearModel::SVC (class)">SVC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rumale/LinearModel/SVC.html#initialize-instance_method" title="Rumale::LinearModel::SVC#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>reg_param:</span> <span class='float'>0.0001</span><span class='comma'>,</span> <span class='label'>random_seed:</span> <span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_pipeline'>pipeline</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/Pipeline.html" title="Rumale::Pipeline (module)">Pipeline</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/Pipeline/Pipeline.html" title="Rumale::Pipeline::Pipeline (class)">Pipeline</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rumale/Pipeline/Pipeline.html#initialize-instance_method" title="Rumale::Pipeline::Pipeline#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>steps:</span> <span class='lbrace'>{</span> <span class='label'>trns:</span> <span class='id identifier rubyid_rbf'>rbf</span><span class='comma'>,</span> <span class='label'>clsf:</span> <span class='id identifier rubyid_svc'>svc</span> <span class='rbrace'>}</span><span class='rparen'>)</span>

<span class='comment'># Define the splitting strategy and cross validation.
</span><span class='id identifier rubyid_kf'>kf</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/ModelSelection.html" title="Rumale::ModelSelection (module)">ModelSelection</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/ModelSelection/StratifiedKFold.html" title="Rumale::ModelSelection::StratifiedKFold (class)">StratifiedKFold</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rumale/ModelSelection/StratifiedKFold.html#initialize-instance_method" title="Rumale::ModelSelection::StratifiedKFold#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>n_splits:</span> <span class='int'>5</span><span class='comma'>,</span> <span class='label'>shuffle:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>random_seed:</span> <span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_cv'>cv</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/ModelSelection.html" title="Rumale::ModelSelection (module)">ModelSelection</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/ModelSelection/CrossValidation.html" title="Rumale::ModelSelection::CrossValidation (class)">CrossValidation</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rumale/ModelSelection/CrossValidation.html#initialize-instance_method" title="Rumale::ModelSelection::CrossValidation#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>estimator:</span> <span class='id identifier rubyid_pipeline'>pipeline</span><span class='comma'>,</span> <span class='label'>splitter:</span> <span class='id identifier rubyid_kf'>kf</span><span class='rparen'>)</span>

<span class='comment'># Perform 5-cross validation.
</span><span class='id identifier rubyid_report'>report</span> <span class='op'>=</span> <span class='id identifier rubyid_cv'>cv</span><span class='period'>.</span><span class='id identifier rubyid_perform'>perform</span><span class='lparen'>(</span><span class='id identifier rubyid_samples'>samples</span><span class='comma'>,</span> <span class='id identifier rubyid_labels'>labels</span><span class='rparen'>)</span>

<span class='comment'># Output result.
</span><span class='id identifier rubyid_mean_accuracy'>mean_accuracy</span> <span class='op'>=</span> <span class='id identifier rubyid_report'>report</span><span class='lbracket'>[</span><span class='symbol'>:test_score</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='symbol'>:+</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='id identifier rubyid_kf'>kf</span><span class='period'>.</span><span class='id identifier rubyid_n_splits'>n_splits</span>
<span class='id identifier rubyid_puts'>puts</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5-CV mean accuracy: %.1f %%</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lparen'>(</span><span class='id identifier rubyid_mean_accuracy'>mean_accuracy</span> <span class='op'>*</span> <span class='float'>100.0</span><span class='rparen'>)</span><span class='rparen'>)</span>
</code></pre>

<p>Execution of the above scripts result in the following.</p>

<pre class="code ruby"><code class="ruby">$ ruby pipeline.rb
5-CV mean accuracy: 99.6 %
</code></pre>

<h2 id="label-Speeding+up">Speeding up</h2>

<h3 id="label-Numo-3A-3ALinalg">Numo::Linalg</h3>

<p>Loading the <a href="https://github.com/ruby-numo/numo-linalg">Numo::Linalg</a> allows to perform matrix product of Numo::NArray using BLAS libraries. For example, using the <a href="https://github.com/xianyi/OpenBLAS">OpenBLAS</a> speeds up many estimators in Rumale.</p>

<p>Install OpenBLAS library.</p>

<p>Mac:</p>

<pre class="code ruby"><code class="ruby">$ brew install openblas
</code></pre>

<p>Ubuntu:</p>

<pre class="code ruby"><code class="ruby">$ sudo apt-get install gcc gfortran
$ wget https://github.com/xianyi/OpenBLAS/archive/v0.3.5.tar.gz
$ tar xzf v0.3.5.tar.gz
$ cd OpenBLAS-0.3.5
$ make USE_OPENMP=1
$ sudo make PREFIX=/usr/local install
</code></pre>

<p>Install Numo::Linalg gem.</p>

<pre class="code ruby"><code class="ruby">$ gem install numo-linalg
</code></pre>

<p>In ruby script, you only need to require the autoloader module of Numo::Linalg.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>numo/linalg/autoloader</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rumale</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<h3 id="label-Parallel">Parallel</h3>

<p>Several estimators in Rumale support parallel processing. Parallel processing in Rumale is realized by <a href="https://github.com/grosser/parallel">Parallel</a> gem, so install and load it.</p>

<pre class="code ruby"><code class="ruby">$ gem install parallel
</code></pre>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>parallel</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rumale</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>Estimators that support parallel processing have n_jobs parameter. When -1 is given to n_jobs parameter, all processors are used.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_estimator'>estimator</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rumale.html" title="Rumale (module)">Rumale</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/Ensemble.html" title="Rumale::Ensemble (module)">Ensemble</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rumale/Ensemble/RandomForestClassifier.html" title="Rumale::Ensemble::RandomForestClassifier (class)">RandomForestClassifier</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rumale/Ensemble/RandomForestClassifier.html#initialize-instance_method" title="Rumale::Ensemble::RandomForestClassifier#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>n_jobs:</span> <span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='label'>random_seed:</span> <span class='int'>1</span><span class='rparen'>)</span>
</code></pre>

<h2 id="label-Development">Development</h2>

<p>After checking out the repo, run <code>bin/setup</code> to install dependencies. Then, run <code>rake spec</code> to run the tests. You can also run <code>bin/console</code> for an interactive prompt that will allow you to experiment.</p>

<p>To install this gem onto your local machine, run <code>bundle exec rake install</code>. To release a new version, update the version number in <code>version.rb</code>, and then run <code>bundle exec rake release</code>, which will create a git tag for the version, push git commits and tags, and push the <code>.gem</code> file to <a href="https://rubygems.org">rubygems.org</a>.</p>

<h2 id="label-Contributing">Contributing</h2>

<p>Bug reports and pull requests are welcome on GitHub at <a href="https://github.com/yoshoku/rumale">github.com/yoshoku/rumale</a>. This project is intended to be a safe, welcoming space for collaboration, and contributors are expected to adhere to the <a href="http://contributor-covenant.org">Contributor Covenant</a> code of conduct.</p>

<h2 id="label-License">License</h2>

<p>The gem is available as open source under the terms of the <a href="https://opensource.org/licenses/BSD-2-Clause">BSD 2-clause License</a>.</p>

<h2 id="label-Code+of+Conduct">Code of Conduct</h2>

<p>Everyone interacting in the Rumale projectâ€™s codebases, issue trackers, chat rooms and mailing lists is expected to follow the <a href="https://github.com/yoshoku/Rumale/blob/master/CODE_OF_CONDUCT.md">code of conduct</a>.</p>
</div></div>

      <div id="footer">
  Generated on Sat Apr 11 10:27:57 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.24 (ruby-2.7.0).
</div>

    </div>
  </body>
</html>