<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.28
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1 id="rumale">Rumale</h1>

<p><img src="https://dl.dropboxusercontent.com/s/joxruk2720ur66o/rumale_header_400.png" alt="Rumale" /></p>

<p><a href="https://github.com/yoshoku/rumale/actions/workflows/main.yml"><img src="https://github.com/yoshoku/rumale/actions/workflows/main.yml/badge.svg" alt="Build Status" /></a>
<a href="https://badge.fury.io/rb/rumale"><img src="https://badge.fury.io/rb/rumale.svg" alt="Gem Version" /></a>
<a href="https://github.com/yoshoku/rumale/blob/main/LICENSE.txt"><img src="https://img.shields.io/badge/License-BSD%203--Clause-orange.svg" alt="BSD 3-Clause License" /></a>
<a href="https://yoshoku.github.io/rumale/doc/"><img src="https://img.shields.io/badge/api-reference-blue.svg" alt="Documentation" /></a></p>

<p>Rumale (<strong>Ru</strong>by <strong>ma</strong>chine <strong>le</strong>arning) is a machine learning library in Ruby.
Rumale provides machine learning algorithms with interfaces similar to Scikit-Learn in Python.
Rumale supports Support Vector Machine,
Logistic Regression, Ridge, Lasso,
Multi-layer Perceptron,
Naive Bayes, Decision Tree, Gradient Tree Boosting, Random Forest,
K-Means, Gaussian Mixture Model, DBSCAN, Spectral Clustering,
Mutidimensional Scaling, t-SNE,
Fisher Discriminant Analysis, Neighbourhood Component Analysis,
Principal Component Analysis, Non-negative Matrix Factorization,
and many other algorithms.</p>

<h2 id="installation">Installation</h2>

<p>Add this line to your application’s Gemfile:</p>

<p><code>ruby
gem 'rumale'
</code></p>

<p>And then execute:</p>

<pre class="code ruby"><code class="ruby">$ bundle
</code></pre>

<p>Or install it yourself as:</p>

<pre class="code ruby"><code class="ruby">$ gem install rumale
</code></pre>

<h2 id="documentation">Documentation</h2>

<ul>
  <li><a href="https://yoshoku.github.io/rumale/doc/">Rumale API Documentation</a></li>
</ul>

<h2 id="usage">Usage</h2>

<h3 id="example-1-pendigits-dataset-classification">Example 1. Pendigits dataset classification</h3>

<p>Rumale provides function loading libsvm format dataset file.
We start by downloading the pendigits dataset from LIBSVM Data web site.</p>

<p><code>bash
$ wget https://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/multiclass/pendigits
$ wget https://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/multiclass/pendigits.t
</code></p>

<p>Training of the classifier with Linear SVM and RBF kernel feature map is the following code.</p>

<p>```ruby
require ‘rumale’</p>

<h1 id="load-the-training-dataset">Load the training dataset.</h1>
<p>samples, labels = Rumale::Dataset.load_libsvm_file(‘pendigits’)</p>

<h1 id="map-training-data-to-rbf-kernel-feature-space">Map training data to RBF kernel feature space.</h1>
<p>transformer = Rumale::KernelApproximation::RBF.new(gamma: 0.0001, n_components: 1024, random_seed: 1)
transformed = transformer.fit_transform(samples)</p>

<h1 id="train-linear-svm-classifier">Train linear SVM classifier.</h1>
<p>classifier = Rumale::LinearModel::SVC.new(reg_param: 0.0001)
classifier.fit(transformed, labels)</p>

<h1 id="save-the-model">Save the model.</h1>
<p>File.open(‘transformer.dat’, ‘wb’) { |f| f.write(Marshal.dump(transformer)) }
File.open(‘classifier.dat’, ‘wb’) { |f| f.write(Marshal.dump(classifier)) }
```</p>

<p>Classifying testing data with the trained classifier is the following code.</p>

<p>```ruby
require ‘rumale’</p>

<h1 id="load-the-testing-dataset">Load the testing dataset.</h1>
<p>samples, labels = Rumale::Dataset.load_libsvm_file(‘pendigits.t’)</p>

<h1 id="load-the-model">Load the model.</h1>
<p>transformer = Marshal.load(File.binread(‘transformer.dat’))
classifier = Marshal.load(File.binread(‘classifier.dat’))</p>

<h1 id="map-testing-data-to-rbf-kernel-feature-space">Map testing data to RBF kernel feature space.</h1>
<p>transformed = transformer.transform(samples)</p>

<h1 id="classify-the-testing-data-and-evaluate-prediction-results">Classify the testing data and evaluate prediction results.</h1>
<p>puts(“Accuracy: %.1f%%” % (100.0 * classifier.score(transformed, labels)))</p>

<h1 id="other-evaluating-approach">Other evaluating approach</h1>
<p># results = classifier.predict(transformed)
# evaluator = Rumale::EvaluationMeasure::Accuracy.new
# puts(“Accuracy: %.1f%%” % (100.0 * evaluator.score(results, labels)))
```</p>

<p>Execution of the above scripts result in the following.</p>

<p><code>bash
$ ruby train.rb
$ ruby test.rb
Accuracy: 98.5%
</code></p>

<h3 id="example-2-cross-validation">Example 2. Cross-validation</h3>

<p>```ruby
require ‘rumale’</p>

<h1 id="load-dataset">Load dataset.</h1>
<p>samples, labels = Rumale::Dataset.load_libsvm_file(‘pendigits’)</p>

<h1 id="define-the-estimator-to-be-evaluated">Define the estimator to be evaluated.</h1>
<p>lr = Rumale::LinearModel::LogisticRegression.new</p>

<h1 id="define-the-evaluation-measure-splitting-strategy-and-cross-validation">Define the evaluation measure, splitting strategy, and cross validation.</h1>
<p>ev = Rumale::EvaluationMeasure::Accuracy.new
kf = Rumale::ModelSelection::StratifiedKFold.new(n_splits: 5, shuffle: true, random_seed: 1)
cv = Rumale::ModelSelection::CrossValidation.new(estimator: lr, splitter: kf, evaluator: ev)</p>

<h1 id="perform-5-cross-validation">Perform 5-cross validation.</h1>
<p>report = cv.perform(samples, labels)</p>

<h1 id="output-result">Output result.</h1>
<p>mean_accuracy = report[:test_score].sum / kf.n_splits
puts “5-CV mean accuracy: %.1f%%” % (100.0 * mean_accuracy)
```</p>

<p>Execution of the above scripts result in the following.</p>

<p><code>bash
$ ruby cross_validation.rb
5-CV mean accuracy: 95.5%
</code></p>

<h2 id="speedup">Speedup</h2>

<h3 id="numolinalg">Numo::Linalg</h3>
<p>Rumale uses <a href="https://github.com/ruby-numo/numo-narray">Numo::NArray</a> for typed arrays.
Loading the <a href="https://github.com/ruby-numo/numo-linalg">Numo::Linalg</a> allows to perform matrix and vector product of Numo::NArray
using BLAS libraries.
Some machine learning algorithms frequently compute matrix and vector products,
the execution speed of such algorithms can be expected to be accelerated.</p>

<p>Install Numo::Linalg gem.</p>

<p><code>bash
$ gem install numo-linalg
</code></p>

<p>In ruby script, just load Numo::Linalg along with Rumale.</p>

<p><code>ruby
require 'numo/linalg/autoloader'
require 'rumale'
</code></p>

<h3 id="numoopenblas">Numo::OpenBLAS</h3>
<p><a href="https://github.com/yoshoku/numo-openblas">Numo::OpenBLAS</a> downloads and builds OpenBLAS during installation
and uses that as a background library for Numo::Linalg.</p>

<p>Install compilers for building OpenBLAS.</p>

<p><code>bash
$ sudo apt-get install gcc gfortran make
</code></p>

<p>Install Numo::OpenBLAS gem.</p>

<p><code>bash
$ gem install numo-openblas
</code></p>

<p>Load Numo::OpenBLAS gem instead of Numo::Linalg.</p>

<p><code>ruby
require 'numo/openblas'
require 'rumale'
</code></p>

<h3 id="numoblis">Numo::BLIS</h3>
<p><a href="https://github.com/yoshoku/numo-blis">Numo::BLIS</a> downloads and builds BLIS during installation
and uses that as a background library for Numo::Linalg.
BLIS is one of the high-performance BLAS as with OpenBLAS,
and using that can be expected to speed up of processing in Rumale.</p>

<p>Install Numo::BLIS gem.</p>

<p><code>bash
$ gem install numo-blis
</code></p>

<p>Load Numo::BLIS gem instead of Numo::Linalg.</p>

<p><code>ruby
require 'numo/blis'
require 'rumale'
</code></p>

<h3 id="parallel">Parallel</h3>
<p>Several estimators in Rumale support parallel processing.
Parallel processing in Rumale is realized by <a href="https://github.com/grosser/parallel">Parallel</a> gem,
so install and load it.</p>

<p><code>bash
$ gem install parallel
</code></p>

<p><code>ruby
require 'parallel'
require 'rumale'
</code></p>

<p>Estimators that support parallel processing have n_jobs parameter.
When -1 is given to n_jobs parameter, all processors are used.</p>

<p><code>ruby
estimator = Rumale::Ensemble::RandomForestClassifier.new(n_jobs: -1, random_seed: 1)
</code></p>

<h2 id="related-projects">Related Projects</h2>

<ul>
  <li><a href="https://github.com/yoshoku/rumale-svm">Rumale::SVM</a> provides support vector machine algorithms in LIBSVM and LIBLINEAR with Rumale interface.</li>
  <li><a href="https://github.com/yoshoku/rumale-torch">Rumale::Torch</a> provides the learning and inference by the neural network defined in torch.rb with Rumale interface.</li>
</ul>

<h2 id="license">License</h2>

<p>The gem is available as open source under the terms of the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD-3-Clause License</a>.</p>
</div></div>

      <div id="footer">
  Generated on Sun Feb 19 21:33:42 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.28 (ruby-3.1.3).
</div>

    </div>
  </body>
</html>